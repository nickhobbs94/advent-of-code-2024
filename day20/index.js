const maze_test = 
`###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############`
const maze_real = 
`#############################################################################################################################################
#...#...#.........#...###...#...###.....###...#...#.....#...#.....#.....#...#.....#...#.......#...#...#...#...###.................###...#...#
#.#.#.#.#.#######.#.#.###.#.#.#.###.###.###.#.#.#.#.###.#.#.#.###.#.###.#.#.#.###.#.#.#.#####.#.#.#.#.#.#.#.#.###.###############.###.#.#.#.#
#.#...#.#...#...#...#...#.#.#.#...#...#.....#...#.#.#...#.#.#.#...#...#.#.#.#.#...#.#.#.....#.#.#.#.#.#.#.#.#.....#...............#...#.#.#.#
#.#####.###.#.#.#######.#.#.#.###.###.###########.#.#.###.#.#.#.#####.#.#.#.#.#.###.#.#####.#.#.#.#.#.#.#.#.#######.###############.###.#.#.#
#.....#...#...#.......#...#.#...#...#.....#...#...#.#...#.#.#.#...#...#.#.#.#.#...#.#.#...#.#.#.#...#.#.#.#.#.......###.....###...#.#...#.#.#
#####.###.###########.#####.###.###.#####.#.#.#.###.###.#.#.#.###.#.###.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.#.#.#########.###.###.#.#.#.###.#.#
#...#...#.###...#...#.....#...#...#.#...#...#.#.....#...#.#...#...#...#.#.#...#...#.#...#.#.#.#.....#.#.#...#.#.......#...#...#.#.#.#...#.#.#
#.#.###.#.###.#.#.#.#####.###.###.#.#.#.#####.#######.###.#####.#####.#.#.#####.###.#####.#.#.#####.#.#.#####.#.#####.###.###.#.#.#.###.#.#.#
#.#.#...#.....#...#.#...#...#.###.#...#...###.......#.###...#...#...#.#.#.....#...#.....#.#.#.......#.#.....#.#.....#.#...#...#.#.#...#...#.#
#.#.#.#############.#.#.###.#.###.#######.#########.#.#####.#.###.#.#.#.#####.###.#####.#.#.#########.#####.#.#####.#.#.###.###.#.###.#####.#
#.#...#...#.......#...#.#...#...#.#.......#...#.....#...#...#.....#.#.#.###...#...#...#.#.#.........#.#.....#.....#.#.#...#...#.#...#.#.....#
#.#####.#.#.#####.#####.#.#####.#.#.#######.#.#.#######.#.#########.#.#.###.###.###.#.#.#.#########.#.#.#########.#.#.###.###.#.###.#.#.#####
#.#...#.#...#...#...#...#.....#...#...#...#.#.#.......#...#.....#...#.#...#.#...#...#.#.#.#...#...#.#.#...#...#...#.#.....#...#.#...#.#.....#
#.#.#.#.#####.#.###.#.#######.#######.#.#.#.#.#######.#####.###.#.###.###.#.#.###.###.#.#.#.#.#.#.#.#.###.#.#.#.###.#######.###.#.###.#####.#
#.#.#.#.#.....#...#.#...#...#.......#.#.#.#.#.....###...#...###...#...#...#.#.....#...#.#.#.#.#.#.#.#.#...#.#...###...#...#.....#.#...#.....#
#.#.#.#.#.#######.#.###.#.#.#######.#.#.#.#.#####.#####.#.#########.###.###.#######.###.#.#.#.#.#.#.#.#.###.#########.#.#.#######.#.###.#####
#.#.#.#.#...#...#...#...#.#.#...#...#...#...#.....#...#.#.###.....#...#.###.#.......#...#.#.#...#.#.#.#.#...#.......#...#.#.......#.#...#...#
#.#.#.#.###.#.#.#####.###.#.#.#.#.###########.#####.#.#.#.###.###.###.#.###.#.#######.###.#.#####.#.#.#.#.###.#####.#####.#.#######.#.###.#.#
#...#...#...#.#.....#...#.#.#.#.#.....#.......#...#.#...#.#...#...#...#...#.#.###...#...#.#...#...#.#...#...#.#.....###...#.#.......#...#.#.#
#########.###.#####.###.#.#.#.#.#####.#.#######.#.#.#####.#.###.###.#####.#.#.###.#.###.#.###.#.###.#######.#.#.#######.###.#.#########.#.#.#
#.......#.....#...#...#...#.#.#.#...#.#...#...#.#.#.....#.#.#...#...#...#.#.#.#...#...#.#.#...#.#...#.......#.#.....#...#...#.#.........#.#.#
#.#####.#######.#.###.#####.#.#.#.#.#.###.#.#.#.#.#####.#.#.#.###.###.#.#.#.#.#.#####.#.#.#.###.#.###.#######.#####.#.###.###.#.#########.#.#
#.....#...###...#.###...#...#.#.#.#.#...#.#.#...#.#...#.#...#.#...#...#...#.#.#.#.....#.#.#...#.#...#...#...#.#.....#...#.#...#...........#.#
#####.###.###.###.#####.#.###.#.#.#.###.#.#.#####.#.#.#.#####.#.###.#######.#.#.#.#####.#.###.#.###.###.#.#.#.#.#######.#.#.###############.#
#...#.#...#...#...#...#.#.....#.#.#.###.#.#.#.....#.#.#.#...#.#.#...#...#...#.#.#...###.#.#...#.....#...#.#.#.#...#...#.#...#...#.........#.#
#.#.#.#.###.###.###.#.#.#######.#.#.###.#.#.#.#####.#.#.#.#.#.#.#.###.#.#.###.#.###.###.#.#.#########.###.#.#.###.#.#.#.#####.#.#.#######.#.#
#.#...#...#...#.#...#...#.....#...#.#...#...#...#...#.#...#.#.#.#.....#.#...#.#.#...#...#.#.....#...#.#...#.#.#...#.#...#...#.#.#.......#.#.#
#.#######.###.#.#.#######.###.#####.#.#########.#.###.#####.#.#.#######.###.#.#.#.###.###.#####.#.#.#.#.###.#.#.###.#####.#.#.#.#######.#.#.#
#.......#.#...#.#...#...#.#...#...#...#.........#...#...###.#.#...#.....###.#.#.#.###...#.#...#.#.#...#.#...#.#.#...#...#.#.#.#...#...#.#.#.#
#######.#.#.###.###.#.#.#.#.###.#.#####.###########.###.###.#.###.#.#######.#.#.#.#####.#.#.#.#.#.#####.#.###.#.#.###.#.#.#.#.###.#.#.#.#.#.#
#...#...#.#...#.###...#...#...#.#.#...#...#.....###...#...#.#.#...#.#####...#.#.#.#...#.#.#.#...#.....#.#.###.#.#.#...#.#.#.#...#...#...#...#
#.#.#.###.###.#.#############.#.#.#.#.###.#.###.#####.###.#.#.#.###.#####.###.#.#.#.#.#.#.#.#########.#.#.###.#.#.#.###.#.#.###.#############
#.#.#...#.....#.#.....#.....#...#...#...#.#.#...#...#.#...#.#.#.#...#####...#.#.#.#.#.#.#.#...#.......#.#.#...#.#.#.###...#.....###.........#
#.#.###.#######.#.###.#.###.###########.#.#.#.###.#.#.#.###.#.#.#.#########.#.#.#.#.#.#.#.###.#.#######.#.#.###.#.#.###############.#######.#
#.#...#.......#.#.#...#...#.#...###...#.#.#.#.#...#.#.#...#.#...#.#########S#.#.#.#.#.#.#...#.#...#...#.#...#...#.#.......#.....#...#...#...#
#.###.#######.#.#.#.#####.#.#.#.###.#.#.#.#.#.#.###.#.###.#.#####.###########.#.#.#.#.#.###.#.###.#.#.#.#####.###.#######.#.###.#.###.#.#.###
#...#.###.....#.#.#.###...#.#.#.#...#.#.#.#.#.#.###.#.###.#.#.....###########.#.#.#.#.#.#...#...#.#.#...#...#.#...#...#...#.#...#.#...#...###
###.#.###.#####.#.#.###.###.#.#.#.###.#.#.#.#.#.###.#.###.#.#.###############.#.#.#.#.#.#.#####.#.#.#####.#.#.#.###.#.#.###.#.###.#.#########
#...#.#...#...#...#...#...#.#.#.#...#.#.#.#.#.#.#...#...#...#...#############.#.#.#.#...#.#...#.#.#.#.....#...#.#...#...#...#.....#...#.....#
#.###.#.###.#.#######.###.#.#.#.###.#.#.#.#.#.#.#.#####.#######.#############.#.#.#.#####.#.#.#.#.#.#.#########.#.#######.###########.#.###.#
#...#.#.....#...#...#.....#...#.....#...#...#.#.#.#...#.......#.#######.......#.#.#.....#...#.#.#.#.#.#.........#.....#...#...........#.#...#
###.#.#########.#.#.#########################.#.#.#.#.#######.#.#######.#######.#.#####.#####.#.#.#.#.#.#############.#.###.###########.#.###
#...#...###...#.#.#.#.......#...............#...#.#.#...#...#.#.#######.#.....#.#.#...#.#.....#.#.#.#.#.#.............#...#.###.........#...#
#.#####.###.#.#.#.#.#.#####.#.#############.#####.#.###.#.#.#.#.#######.#.###.#.#.#.#.#.#.#####.#.#.#.#.#.###############.#.###.###########.#
#.#...#.#...#...#.#.#.#.....#.#.............###...#...#.#.#...#...#####.#.#...#.#.#.#...#.......#...#.#.#.............#...#.....#...#...#...#
#.#.#.#.#.#######.#.#.#.#####.#.###############.#####.#.#.#######.#####.#.#.###.#.#.#################.#.#############.#.#########.#.#.#.#.###
#...#.#...#.....#.#.#.#...#...#...............#.....#.#.#.......#...###.#.#.....#.#.###.........#...#...#...#...#.....#...#...#...#...#.#...#
#####.#####.###.#.#.#.###.#.#################.#####.#.#.#######.###.###.#.#######.#.###.#######.#.#.#####.#.#.#.#.#######.#.#.#.#######.###.#
#.....#.....###...#...###...###...........#...#...#...#.......#.###.###.#.#.......#...#.#.....#...#.......#...#...#...#...#.#.#.....###...#.#
#.#####.#######################.#########.#.###.#.###########.#.###.###.#.#.#########.#.#.###.#####################.#.#.###.#.#####.#####.#.#
#.......#.......................#...#...#...#...#.....#.....#...#...###.#.#.#...#.....#...#...#...#.......#...#...#.#...#...#.......#...#...#
#########.#######################.#.#.#.#####.#######.#.###.#####.#####.#.#.#.#.#.#########.###.#.#.#####.#.#.#.#.#.#####.###########.#.#####
#.........#...#...#...#.......#...#...#.....#.#.......#.#...#...#E#####.#.#.#.#.#.....#.....#...#...#...#...#...#...#.....#...#.......#.....#
#.#########.#.#.#.#.#.#.#####.#.###########.#.#.#######.#.###.#.#######.#.#.#.#.#####.#.#####.#######.#.#############.#####.#.#.###########.#
#.........#.#.#.#.#.#...#...#...###.........#.#.#...#...#.....#...#.....#.#.#.#...#...#.....#.#.......#.............#.....#.#.#.#.........#.#
#########.#.#.#.#.#.#####.#.#######.#########.#.#.#.#.###########.#.#####.#.#.###.#.#######.#.#.###################.#####.#.#.#.#.#######.#.#
#.........#.#...#...###...#.........#...###...#...#...#...#...#...#...#...#...#...#...#.....#.#...................#.#...#...#...#...#...#...#
#.#########.###########.#############.#.###.###########.#.#.#.#.#####.#.#######.#####.#.#####.###################.#.#.#.###########.#.#.#####
#...........#...#...#...#...#...#.....#.....#.........#.#.#.#.#...###.#.......#.....#.#.......###...#...#...#.....#...#.#...#.......#.#.....#
#############.#.#.#.#.###.#.#.#.#.###########.#######.#.#.#.#.###.###.#######.#####.#.###########.#.#.#.#.#.#.#########.#.#.#.#######.#####.#
#.....#.......#.#.#.#...#.#...#...#.........#.......#.#.#...#.#...#...#.......#...#...#...#.......#...#...#.#...###...#...#.#.#.......#.....#
#.###.#.#######.#.#.###.#.#########.#######.#######.#.#.#####.#.###.###.#######.#.#####.#.#.###############.###.###.#.#####.#.#.#######.#####
#.#...#.......#...#.....#...#.......#...###...#.....#.#.....#.#...#...#.###...#.#.#...#.#.#...............#.....#...#.....#...#.#.......#...#
#.#.#########.#############.#.#######.#.#####.#.#####.#####.#.###.###.#.###.#.#.#.#.#.#.#.###############.#######.#######.#####.#.#######.#.#
#.#.#...#.....#...#.....#...#.........#.#...#...#...#.......#.#...#...#...#.#...#...#.#.#.#...............#.....#.#.....#.......#...#.....#.#
#.#.#.#.#.#####.#.#.###.#.#############.#.#.#####.#.#########.#.###.#####.#.#########.#.#.#.###############.###.#.#.###.###########.#.#####.#
#.#.#.#.#.......#...#...#.#.............#.#.......#.........#.#.#...#...#.#.#...#...#.#.#.#...............#.#...#.#.###.............#.#.....#
#.#.#.#.#############.###.#.#############.#################.#.#.#.###.#.#.#.#.#.#.#.#.#.#.###############.#.#.###.#.#################.#.#####
#.#...#...............#...#...............#...#...#...#...#.#.#.#...#.#.#.#.#.#.#.#.#...#.........#.......#.#.#...#.......#...#...###.#.#...#
#.#####################.###################.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#############.#.#######.#.#.#########.#.#.#.#.###.#.#.#.#
#...#...#.....#...#...#.#.................#.#...#...#...#...#...###.#.#.#.#.#.#...#...#.........#.#.........#...#...#.....#.#...#.....#...#.#
###.#.#.#.###.#.#.#.#.#.#.###############.#.#######################.#.#.#.#.#.#######.#.#######.#.###############.#.#.#####.###############.#
###...#...###...#...#...#...............#.#.............###...#...#...#...#...#.......#.#.......#.................#.#...#...#...#...#.......#
#######################################.#.#############.###.#.#.#.#############.#######.#.#########################.###.#.###.#.#.#.#.#######
###.....#.......###.....................#...#.....#...#...#.#.#.#...#...#.....#.........#...#.........#...#.......#...#...#...#.#.#.#.......#
###.###.#.#####.###.#######################.#.###.#.#.###.#.#.#.###.#.#.#.###.#############.#.#######.#.#.#.#####.###.#####.###.#.#.#######.#
#...#...#.#...#...#.#.......#...#...#...###...###.#.#.#...#.#.#.#...#.#.#...#...........###...#.....#...#...#.....###.#...#...#...#.#...#...#
#.###.###.#.#.###.#.#.#####.#.#.#.#.#.#.#########.#.#.#.###.#.#.#.###.#.###.###########.#######.###.#########.#######.#.#.###.#####.#.#.#.###
#...#.###...#...#.#...#...#...#...#...#.........#.#.#.#...#.#...#.....#...#.....#.....#.......#.#...#...#...#.......#.#.#...#.....#.#.#.#.###
###.#.#########.#.#####.#.#####################.#.#.#.###.#.#############.#####.#.###.#######.#.#.###.#.#.#.#######.#.#.###.#####.#.#.#.#.###
#...#.#.....###.#.#...#.#.###...................#...#.#...#.#.....#.......#...#...###.......#...#.....#...#.........#.#.###.......#...#.#...#
#.###.#.###.###.#.#.#.#.#.###.#######################.#.###.#.###.#.#######.#.#############.#########################.#.###############.###.#
#...#...#...#...#...#...#...#.....................###...#...#...#...###.....#...#...###...#.#...#...............#...#...#...###...#...#.#...#
###.#####.###.#############.#####################.#######.#####.#######.#######.#.#.###.#.#.#.#.#.#############.#.#.#####.#.###.#.#.#.#.#.###
#...#...#.#...#...........#.#.................#...#...#...#.....#.....#...#.....#.#.#...#...#.#.#.#.............#.#...#...#.....#...#.#.#...#
#.###.#.#.#.###.#########.#.#.###############.#.###.#.#.###.#####.###.###.#.#####.#.#.#######.#.#.#.#############.###.#.#############.#.###.#
#.....#.#.#.....#.......#.#.#...............#.#...#.#.#...#.#...#.#...#...#...#...#.#.......#.#...#...#...###...#.#...#.#.............#.....#
#######.#.#######.#####.#.#.###############.#.###.#.#.###.#.#.#.#.#.###.#####.#.###.#######.#.#######.#.#.###.#.#.#.###.#.###################
#.......#.......#.....#.#.#.#.............#.#.....#.#...#.#.#.#.#.#...#.#.....#...#.###...#.#...#...#...#.....#...#.....#.............#.....#
#.#############.#####.#.#.#.#.###########.#.#######.###.#.#.#.#.#.###.#.#.#######.#.###.#.#.###.#.#.#################################.#.###.#
#...#...#.....#.#.....#...#...#.........#...#...###...#.#.#...#.#...#.#.#.#...#...#.....#.#.#...#.#...........#.....#.........#.......#.#...#
###.#.#.#.###.#.#.#############.#######.#####.#.#####.#.#.#####.###.#.#.#.#.#.#.#########.#.#.###.###########.#.###.#.#######.#.#######.#.###
###...#...#...#...#.....#...#...#.......#...#.#.#.....#.#.#.....#...#...#.#.#.#.....#.....#...###...........#.#.#...#.......#.#.....#...#...#
###########.#######.###.#.#.#.###.#######.#.#.#.#.#####.#.#.#####.#######.#.#.#####.#.#####################.#.#.#.#########.#.#####.#.#####.#
#...#...#...#...#...###.#.#...###.......#.#.#.#.#.....#...#.....#.#.....#.#.#...#...#...###...###...........#.#.#...#...#...#.#...#...#.....#
#.#.#.#.#.###.#.#.#####.#.#############.#.#.#.#.#####.#########.#.#.###.#.#.###.#.#####.###.#.###.###########.#.###.#.#.#.###.#.#.#####.#####
#.#...#...#...#...#...#...#.......#...#.#.#.#.#...#...#.......#.#...###.#...#...#...#...#...#...#.........###.#...#.#.#.#...#.#.#.#...#.....#
#.#########.#######.#.#####.#####.#.#.#.#.#.#.###.#.###.#####.#.#######.#####.#####.#.###.#####.#########.###.###.#.#.#.###.#.#.#.#.#.#####.#
#.....#.....#...#...#...###.....#...#...#.#.#...#.#...#.....#...###...#.#.....#.....#.#...#.....#...#...#...#.....#...#.#...#...#...#...#...#
#####.#.#####.#.#.#####.#######.#########.#.###.#.###.#####.#######.#.#.#.#####.#####.#.###.#####.#.#.#.###.###########.#.#############.#.###
#...#...#...#.#.#.....#.#...###.......#...#...#.#.#...#.....#.......#.#.#.....#.....#.#.#...#...#.#...#.....#.........#.#.............#.#...#
#.#.#####.#.#.#.#####.#.#.#.#########.#.#####.#.#.#.###.#####.#######.#.#####.#####.#.#.#.###.#.#.###########.#######.#.#############.#.###.#
#.#.#.....#...#.......#...#...#.......#.#.....#.#.#...#.#...#.......#.#.#.....#...#.#.#.#.###.#.#.........#...#.......#...#...........#.....#
#.#.#.#######################.#.#######.#.#####.#.###.#.#.#.#######.#.#.#.#####.#.#.#.#.#.###.#.#########.#.###.#########.#.#################
#.#...#...#.................#...#...#...#.#...#.#.#...#.#.#...#...#.#.#.#.#...#.#.#.#...#.#...#.#...#...#.#.#...#.....#...#...#.............#
#.#####.#.#.###############.#####.#.#.###.#.#.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#.#####.#.###.#.#.#.#.#.#.#.###.###.#.#####.#.###########.#
#.....#.#.#.#.....###...#...#...#.#...#...#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#...#.....#...#...#.#.#.#...#.###.#...#.....#...#...........#
#####.#.#.#.#.###.###.#.#.###.#.#.#####.###.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#####.#######.#####.#.#.#####.###.#.#######.#####.###########
#.....#.#...#...#.....#...#...#.#.....#...#.#...#.#...#.#...#.#.#.#.#...#.#.#.#...#...#.....#...#...#.#.....#.....#.#...###.#...#...#...#...#
#.#####.#######.###########.###.#####.###.#.#####.#.###.#.###.#.#.#.#####.#.#.###.#.###.###.###.#.###.#####.#######.#.#.###.#.#.###.#.#.#.#.#
#.....#...#...#...#...#...#.#...#...#...#...###...#.#...#...#...#.#.....#.#.#...#.#...#...#...#.#...#...#...#.....#...#...#.#.#...#...#...#.#
#####.###.#.#.###.#.#.#.#.#.#.###.#.###.#######.###.#.#####.#####.#####.#.#.###.#.###.###.###.#.###.###.#.###.###.#######.#.#.###.#########.#
#...#.....#.#...#...#.#.#.#.#...#.#...#.#.......#...#.#...#.....#...#...#...###.#.###.#...#...#.#...#...#...#.###.#.......#...###.#...#.....#
#.#.#######.###.#####.#.#.#.###.#.###.#.#.#######.###.#.#.#####.###.#.#########.#.###.#.###.###.#.###.#####.#.###.#.#############.#.#.#.#####
#.#...#...#...#.......#.#...#...#.#...#.#.#...#...###...#...#...###.#.........#...#...#...#.#...#.....#...#.#.#...#.....###.....#.#.#.#.....#
#.###.#.#.###.#########.#####.###.#.###.#.#.#.#.###########.#.#####.#########.#####.#####.#.#.#########.#.#.#.#.#######.###.###.#.#.#.#####.#
#...#.#.#.###...#...#...#.....#...#...#.#.#.#.#.#...#.......#.#...#.....#...#.#.....#...#.#.#...#.......#...#.#.......#...#.#...#...#.....#.#
###.#.#.#.#####.#.#.#.###.#####.#####.#.#.#.#.#.#.#.#.#######.#.#.#####.#.#.#.#.#####.#.#.#.###.#.###########.#######.###.#.#.###########.#.#
#...#...#.#...#...#.#.###.....#.#.....#.#.#.#.#...#.#.#.....#...#.....#.#.#...#...#...#...#.....#.#.....#...#.......#...#...#...#.....###...#
#.#######.#.#.#####.#.#######.#.#.#####.#.#.#.#####.#.#.###.#########.#.#.#######.#.#############.#.###.#.#.#######.###.#######.#.###.#######
#.......#...#.......#...###...#.#.#...#.#...#.#.....#...###...#...#...#.#.....###...#.........###...#...#.#.....#...###.#...#...#.#...#...###
#######.###############.###.###.#.#.#.#.#####.#.#############.#.#.#.###.#####.#######.#######.#######.###.#####.#.#####.#.#.#.###.#.###.#.###
#.......#...#...#.....#...#...#.#...#.#.#.....#.......#...#...#.#.#...#.#...#.......#.......#.........#...#.....#.....#.#.#.#.....#.....#...#
#.#######.#.#.#.#.###.###.###.#.#####.#.#.###########.#.#.#.###.#.###.#.#.#.#######.#######.###########.###.#########.#.#.#.###############.#
#...#...#.#...#.#...#...#.###.#.###...#.#.#...#.....#.#.#.#.#...#.....#.#.#...#.....###...#.#.......#...###.......#...#...#.#.............#.#
###.#.#.#.#####.###.###.#.###.#.###.###.#.#.#.#.###.#.#.#.#.#.#########.#.###.#.#######.#.#.#.#####.#.###########.#.#######.#.###########.#.#
#...#.#.#...#...#...###.#.#...#...#.#...#.#.#.#...#.#.#.#...#.........#.#.#...#.......#.#...#.....#.#.......#.....#.....###.#...........#.#.#
#.###.#.###.#.###.#####.#.#.#####.#.#.###.#.#.###.#.#.#.#############.#.#.#.#########.#.#########.#.#######.#.#########.###.###########.#.#.#
#.#...#...#.#.#...#.....#.#...#...#.#...#...#.#...#...#...#...#...#...#.#.#...#.....#.#...#...#...#.....#...#.#...#...#...#...#.......#.#.#.#
#.#.#####.#.#.#.###.#####.###.#.###.###.#####.#.#########.#.#.#.#.#.###.#.###.#.###.#.###.#.#.#.#######.#.###.#.#.#.#.###.###.#.#####.#.#.#.#
#...#.....#.#.#.###...#...#...#...#.#...#...#.#...###.....#.#.#.#.#...#.#.#...#...#.#.#...#.#.#.#.......#...#.#.#.#.#.#...#...#...###...#...#
#####.#####.#.#.#####.#.###.#####.#.#.###.#.#.###.###.#####.#.#.#.###.#.#.#.#####.#.#.#.###.#.#.#.#########.#.#.#.#.#.#.###.#####.###########
#.....#...#.#...#...#...###.#...#.#.#.#...#...#...#...#.....#...#.#...#.#.#...#...#...#...#.#.#.#.#.....#...#.#.#.#.#.#.###.....#.........###
#.#####.#.#.#####.#.#######.#.#.#.#.#.#.#######.###.###.#########.#.###.#.###.#.#########.#.#.#.#.#.###.#.###.#.#.#.#.#.#######.#########.###
#...#...#.#.#.....#.###.....#.#.#.#.#.#.#...#...###...#.......###...###...###...###...#...#.#.#.#.#.###.#.###.#.#.#.#.#.......#...#.....#...#
###.#.###.#.#.#####.###.#####.#.#.#.#.#.#.#.#.#######.#######.#####################.#.#.###.#.#.#.#.###.#.###.#.#.#.#.#######.###.#.###.###.#
#...#...#.#.#.#...#.....#...#.#.#.#.#.#.#.#.#.#.......#.....#...................#...#...#...#.#.#.#.#...#...#.#.#.#.#...#...#.#...#...#...#.#
#.#####.#.#.#.#.#.#######.#.#.#.#.#.#.#.#.#.#.#.#######.###.###################.#.#######.###.#.#.#.#.#####.#.#.#.#.###.#.#.#.#.#####.###.#.#
#.......#...#...#.........#...#...#...#...#...#.........###.....................#.........###...#...#.......#...#...###...#...#.......###...#
#############################################################################################################################################`


const maze = maze_real.split('\n').map(row => row.split(''));

const height = maze.length; const width = maze[0].length;

const validNext = ([x2,y2], phasing) => (x2 >= 0 && x2 < width && y2 >= 0 && y2 < height) && (maze[y2][x2] !== '#' || phasing);

const findCoords = letter => {
  const y = maze.findIndex(row => row.find(v => v === letter));
  const x = maze[y].findIndex(v => v === letter);
  return [x,y];
}

const start = findCoords('S');
const end = findCoords('E');

const printPos = (spots, symbol) => {
  symbol ??= 'X'
  const inspots = ([x,y]) => spots.find(e => e[0] === x && e[1] === y);
  for (let y=0; y<height; y++) {
    let s = '';
    for (let x=0; x<width; x++) {
      if (inspots([x,y])) {
        s += symbol;
      } else {
        s += maze[y][x];
      }
    }
    console.log(s);
  }
}

function solve() {
  const costs = {};
  let positions = [{pos: start, cost: 0}];
  let baseCost;

  while (positions.length) {

    const {pos, cost} = positions.pop();
  
    const lookupKey = `${pos}`;
    const [x,y] = pos;

    if (costs[lookupKey] === undefined || costs[lookupKey] > cost) {
      costs[lookupKey] = cost;
    } else {
      continue;
    }

    const pushNext = (vec, newcost, delta) => {
      vec = [vec[0] + delta[0], vec[1] + delta[1]]
      if (validNext(vec, false)) {
        positions.push({pos: vec, cost: newcost})
      }
    }

    pushNext([x,y], cost+1, [1,0]);
    pushNext([x,y], cost+1, [-1,0]);
    pushNext([x,y], cost+1, [0,1]);
    pushNext([x,y], cost+1, [0,-1]);
  
    // FOUND IT!
    if (x === end[0] && y === end[1]) {
      baseCost ??= cost;
      baseCost = Math.min(baseCost, cost);
    }
  }
  return {costs};
}

const {costs} = solve();

// console.log(costs);


const savings = {};
for (let y=0; y<height; y++) {
  for (let x=0; x<width; x++) {

    const base = costs[`${x},${y}`];
    if (base === undefined) continue;

    const shortcuts = Object.keys(costs).map(e => {
      const [x1,y1] = e.split(',').map(i => parseInt(i));
      
      const distance = Math.abs(x - x1) + Math.abs(y - y1);
      const newcost = base + distance;
      const delta = costs[e] - newcost;
      // console.log(x,y,base,x1,y1,distance,delta);
      return distance <= 20 ? delta : 0;
    }).filter(v => v > 0);

    for (let sc of shortcuts) {
      savings[sc] ??= 0;
      savings[sc] += 1;
    }
  }
}



console.log("XXXXXXXXXXXX")

// for (const [k,v] of Object.entries(savings).filter(([a,b]) => a >= 50).sort(([a], [b]) => a-b)) {
//   console.log(k,v);
// }

console.log(Object.entries(savings).filter(([k,v]) => k >= 100).reduce((acc,[k,v]) => acc + v, 0));

