const maze = 
`#############################################################################################################################################
#...#...#.........#...###...#...###.....###...#...#.....#...#.....#.....#...#.....#...#.......#...#...#...#...###.................###...#...#
#.#.#.#.#.#######.#.#.###.#.#.#.###.###.###.#.#.#.#.###.#.#.#.###.#.###.#.#.#.###.#.#.#.#####.#.#.#.#.#.#.#.#.###.###############.###.#.#.#.#
#.#...#.#...#...#...#...#.#.#.#...#...#.....#...#.#.#...#.#.#.#...#...#.#.#.#.#...#.#.#.....#.#.#.#.#.#.#.#.#.....#...............#...#.#.#.#
#.#####.###.#.#.#######.#.#.#.###.###.###########.#.#.###.#.#.#.#####.#.#.#.#.#.###.#.#####.#.#.#.#.#.#.#.#.#######.###############.###.#.#.#
#.....#...#...#.......#...#.#...#...#.....#...#...#.#...#.#.#.#...#...#.#.#.#.#...#.#.#...#.#.#.#...#.#.#.#.#.......###.....###...#.#...#.#.#
#####.###.###########.#####.###.###.#####.#.#.#.###.###.#.#.#.###.#.###.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.#.#.#########.###.###.#.#.#.###.#.#
#...#...#.###...#...#.....#...#...#.#...#...#.#.....#...#.#...#...#...#.#.#...#...#.#...#.#.#.#.....#.#.#...#.#.......#...#...#.#.#.#...#.#.#
#.#.###.#.###.#.#.#.#####.###.###.#.#.#.#####.#######.###.#####.#####.#.#.#####.###.#####.#.#.#####.#.#.#####.#.#####.###.###.#.#.#.###.#.#.#
#.#.#...#.....#...#.#...#...#.###.#...#...###.......#.###...#...#...#.#.#.....#...#.....#.#.#.......#.#.....#.#.....#.#...#...#.#.#...#...#.#
#.#.#.#############.#.#.###.#.###.#######.#########.#.#####.#.###.#.#.#.#####.###.#####.#.#.#########.#####.#.#####.#.#.###.###.#.###.#####.#
#.#...#...#.......#...#.#...#...#.#.......#...#.....#...#...#.....#.#.#.###...#...#...#.#.#.........#.#.....#.....#.#.#...#...#.#...#.#.....#
#.#####.#.#.#####.#####.#.#####.#.#.#######.#.#.#######.#.#########.#.#.###.###.###.#.#.#.#########.#.#.#########.#.#.###.###.#.###.#.#.#####
#.#...#.#...#...#...#...#.....#...#...#...#.#.#.......#...#.....#...#.#...#.#...#...#.#.#.#...#...#.#.#...#...#...#.#.....#...#.#...#.#.....#
#.#.#.#.#####.#.###.#.#######.#######.#.#.#.#.#######.#####.###.#.###.###.#.#.###.###.#.#.#.#.#.#.#.#.###.#.#.#.###.#######.###.#.###.#####.#
#.#.#.#.#.....#...#.#...#...#.......#.#.#.#.#.....###...#...###...#...#...#.#.....#...#.#.#.#.#.#.#.#.#...#.#...###...#...#.....#.#...#.....#
#.#.#.#.#.#######.#.###.#.#.#######.#.#.#.#.#####.#####.#.#########.###.###.#######.###.#.#.#.#.#.#.#.#.###.#########.#.#.#######.#.###.#####
#.#.#.#.#...#...#...#...#.#.#...#...#...#...#.....#...#.#.###.....#...#.###.#.......#...#.#.#...#.#.#.#.#...#.......#...#.#.......#.#...#...#
#.#.#.#.###.#.#.#####.###.#.#.#.#.###########.#####.#.#.#.###.###.###.#.###.#.#######.###.#.#####.#.#.#.#.###.#####.#####.#.#######.#.###.#.#
#...#...#...#.#.....#...#.#.#.#.#.....#.......#...#.#...#.#...#...#...#...#.#.###...#...#.#...#...#.#...#...#.#.....###...#.#.......#...#.#.#
#########.###.#####.###.#.#.#.#.#####.#.#######.#.#.#####.#.###.###.#####.#.#.###.#.###.#.###.#.###.#######.#.#.#######.###.#.#########.#.#.#
#.......#.....#...#...#...#.#.#.#...#.#...#...#.#.#.....#.#.#...#...#...#.#.#.#...#...#.#.#...#.#...#.......#.#.....#...#...#.#.........#.#.#
#.#####.#######.#.###.#####.#.#.#.#.#.###.#.#.#.#.#####.#.#.#.###.###.#.#.#.#.#.#####.#.#.#.###.#.###.#######.#####.#.###.###.#.#########.#.#
#.....#...###...#.###...#...#.#.#.#.#...#.#.#...#.#...#.#...#.#...#...#...#.#.#.#.....#.#.#...#.#...#...#...#.#.....#...#.#...#...........#.#
#####.###.###.###.#####.#.###.#.#.#.###.#.#.#####.#.#.#.#####.#.###.#######.#.#.#.#####.#.###.#.###.###.#.#.#.#.#######.#.#.###############.#
#...#.#...#...#...#...#.#.....#.#.#.###.#.#.#.....#.#.#.#...#.#.#...#...#...#.#.#...###.#.#...#.....#...#.#.#.#...#...#.#...#...#.........#.#
#.#.#.#.###.###.###.#.#.#######.#.#.###.#.#.#.#####.#.#.#.#.#.#.#.###.#.#.###.#.###.###.#.#.#########.###.#.#.###.#.#.#.#####.#.#.#######.#.#
#.#...#...#...#.#...#...#.....#...#.#...#...#...#...#.#...#.#.#.#.....#.#...#.#.#...#...#.#.....#...#.#...#.#.#...#.#...#...#.#.#.......#.#.#
#.#######.###.#.#.#######.###.#####.#.#########.#.###.#####.#.#.#######.###.#.#.#.###.###.#####.#.#.#.#.###.#.#.###.#####.#.#.#.#######.#.#.#
#.......#.#...#.#...#...#.#...#...#...#.........#...#...###.#.#...#.....###.#.#.#.###...#.#...#.#.#...#.#...#.#.#...#...#.#.#.#...#...#.#.#.#
#######.#.#.###.###.#.#.#.#.###.#.#####.###########.###.###.#.###.#.#######.#.#.#.#####.#.#.#.#.#.#####.#.###.#.#.###.#.#.#.#.###.#.#.#.#.#.#
#...#...#.#...#.###...#...#...#.#.#...#...#.....###...#...#.#.#...#.#####...#.#.#.#...#.#.#.#...#.....#.#.###.#.#.#...#.#.#.#...#...#...#...#
#.#.#.###.###.#.#############.#.#.#.#.###.#.###.#####.###.#.#.#.###.#####.###.#.#.#.#.#.#.#.#########.#.#.###.#.#.#.###.#.#.###.#############
#.#.#...#.....#.#.....#.....#...#...#...#.#.#...#...#.#...#.#.#.#...#####...#.#.#.#.#.#.#.#...#.......#.#.#...#.#.#.###...#.....###.........#
#.#.###.#######.#.###.#.###.###########.#.#.#.###.#.#.#.###.#.#.#.#########.#.#.#.#.#.#.#.###.#.#######.#.#.###.#.#.###############.#######.#
#.#...#.......#.#.#...#...#.#...###...#.#.#.#.#...#.#.#...#.#...#.#########S#.#.#.#.#.#.#...#.#...#...#.#...#...#.#.......#.....#...#...#...#
#.###.#######.#.#.#.#####.#.#.#.###.#.#.#.#.#.#.###.#.###.#.#####.###########.#.#.#.#.#.###.#.###.#.#.#.#####.###.#######.#.###.#.###.#.#.###
#...#.###.....#.#.#.###...#.#.#.#...#.#.#.#.#.#.###.#.###.#.#.....###########.#.#.#.#.#.#...#...#.#.#...#...#.#...#...#...#.#...#.#...#...###
###.#.###.#####.#.#.###.###.#.#.#.###.#.#.#.#.#.###.#.###.#.#.###############.#.#.#.#.#.#.#####.#.#.#####.#.#.#.###.#.#.###.#.###.#.#########
#...#.#...#...#...#...#...#.#.#.#...#.#.#.#.#.#.#...#...#...#...#############.#.#.#.#...#.#...#.#.#.#.....#...#.#...#...#...#.....#...#.....#
#.###.#.###.#.#######.###.#.#.#.###.#.#.#.#.#.#.#.#####.#######.#############.#.#.#.#####.#.#.#.#.#.#.#########.#.#######.###########.#.###.#
#...#.#.....#...#...#.....#...#.....#...#...#.#.#.#...#.......#.#######.......#.#.#.....#...#.#.#.#.#.#.........#.....#...#...........#.#...#
###.#.#########.#.#.#########################.#.#.#.#.#######.#.#######.#######.#.#####.#####.#.#.#.#.#.#############.#.###.###########.#.###
#...#...###...#.#.#.#.......#...............#...#.#.#...#...#.#.#######.#.....#.#.#...#.#.....#.#.#.#.#.#.............#...#.###.........#...#
#.#####.###.#.#.#.#.#.#####.#.#############.#####.#.###.#.#.#.#.#######.#.###.#.#.#.#.#.#.#####.#.#.#.#.#.###############.#.###.###########.#
#.#...#.#...#...#.#.#.#.....#.#.............###...#...#.#.#...#...#####.#.#...#.#.#.#...#.......#...#.#.#.............#...#.....#...#...#...#
#.#.#.#.#.#######.#.#.#.#####.#.###############.#####.#.#.#######.#####.#.#.###.#.#.#################.#.#############.#.#########.#.#.#.#.###
#...#.#...#.....#.#.#.#...#...#...............#.....#.#.#.......#...###.#.#.....#.#.###.........#...#...#...#...#.....#...#...#...#...#.#...#
#####.#####.###.#.#.#.###.#.#################.#####.#.#.#######.###.###.#.#######.#.###.#######.#.#.#####.#.#.#.#.#######.#.#.#.#######.###.#
#.....#.....###...#...###...###...........#...#...#...#.......#.###.###.#.#.......#...#.#.....#...#.......#...#...#...#...#.#.#.....###...#.#
#.#####.#######################.#########.#.###.#.###########.#.###.###.#.#.#########.#.#.###.#####################.#.#.###.#.#####.#####.#.#
#.......#.......................#...#...#...#...#.....#.....#...#...###.#.#.#...#.....#...#...#...#.......#...#...#.#...#...#.......#...#...#
#########.#######################.#.#.#.#####.#######.#.###.#####.#####.#.#.#.#.#.#########.###.#.#.#####.#.#.#.#.#.#####.###########.#.#####
#.........#...#...#...#.......#...#...#.....#.#.......#.#...#...#E#####.#.#.#.#.#.....#.....#...#...#...#...#...#...#.....#...#.......#.....#
#.#########.#.#.#.#.#.#.#####.#.###########.#.#.#######.#.###.#.#######.#.#.#.#.#####.#.#####.#######.#.#############.#####.#.#.###########.#
#.........#.#.#.#.#.#...#...#...###.........#.#.#...#...#.....#...#.....#.#.#.#...#...#.....#.#.......#.............#.....#.#.#.#.........#.#
#########.#.#.#.#.#.#####.#.#######.#########.#.#.#.#.###########.#.#####.#.#.###.#.#######.#.#.###################.#####.#.#.#.#.#######.#.#
#.........#.#...#...###...#.........#...###...#...#...#...#...#...#...#...#...#...#...#.....#.#...................#.#...#...#...#...#...#...#
#.#########.###########.#############.#.###.###########.#.#.#.#.#####.#.#######.#####.#.#####.###################.#.#.#.###########.#.#.#####
#...........#...#...#...#...#...#.....#.....#.........#.#.#.#.#...###.#.......#.....#.#.......###...#...#...#.....#...#.#...#.......#.#.....#
#############.#.#.#.#.###.#.#.#.#.###########.#######.#.#.#.#.###.###.#######.#####.#.###########.#.#.#.#.#.#.#########.#.#.#.#######.#####.#
#.....#.......#.#.#.#...#.#...#...#.........#.......#.#.#...#.#...#...#.......#...#...#...#.......#...#...#.#...###...#...#.#.#.......#.....#
#.###.#.#######.#.#.###.#.#########.#######.#######.#.#.#####.#.###.###.#######.#.#####.#.#.###############.###.###.#.#####.#.#.#######.#####
#.#...#.......#...#.....#...#.......#...###...#.....#.#.....#.#...#...#.###...#.#.#...#.#.#...............#.....#...#.....#...#.#.......#...#
#.#.#########.#############.#.#######.#.#####.#.#####.#####.#.###.###.#.###.#.#.#.#.#.#.#.###############.#######.#######.#####.#.#######.#.#
#.#.#...#.....#...#.....#...#.........#.#...#...#...#.......#.#...#...#...#.#...#...#.#.#.#...............#.....#.#.....#.......#...#.....#.#
#.#.#.#.#.#####.#.#.###.#.#############.#.#.#####.#.#########.#.###.#####.#.#########.#.#.#.###############.###.#.#.###.###########.#.#####.#
#.#.#.#.#.......#...#...#.#.............#.#.......#.........#.#.#...#...#.#.#...#...#.#.#.#...............#.#...#.#.###.............#.#.....#
#.#.#.#.#############.###.#.#############.#################.#.#.#.###.#.#.#.#.#.#.#.#.#.#.###############.#.#.###.#.#################.#.#####
#.#...#...............#...#...............#...#...#...#...#.#.#.#...#.#.#.#.#.#.#.#.#...#.........#.......#.#.#...#.......#...#...###.#.#...#
#.#####################.###################.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#############.#.#######.#.#.#########.#.#.#.#.###.#.#.#.#
#...#...#.....#...#...#.#.................#.#...#...#...#...#...###.#.#.#.#.#.#...#...#.........#.#.........#...#...#.....#.#...#.....#...#.#
###.#.#.#.###.#.#.#.#.#.#.###############.#.#######################.#.#.#.#.#.#######.#.#######.#.###############.#.#.#####.###############.#
###...#...###...#...#...#...............#.#.............###...#...#...#...#...#.......#.#.......#.................#.#...#...#...#...#.......#
#######################################.#.#############.###.#.#.#.#############.#######.#.#########################.###.#.###.#.#.#.#.#######
###.....#.......###.....................#...#.....#...#...#.#.#.#...#...#.....#.........#...#.........#...#.......#...#...#...#.#.#.#.......#
###.###.#.#####.###.#######################.#.###.#.#.###.#.#.#.###.#.#.#.###.#############.#.#######.#.#.#.#####.###.#####.###.#.#.#######.#
#...#...#.#...#...#.#.......#...#...#...###...###.#.#.#...#.#.#.#...#.#.#...#...........###...#.....#...#...#.....###.#...#...#...#.#...#...#
#.###.###.#.#.###.#.#.#####.#.#.#.#.#.#.#########.#.#.#.###.#.#.#.###.#.###.###########.#######.###.#########.#######.#.#.###.#####.#.#.#.###
#...#.###...#...#.#...#...#...#...#...#.........#.#.#.#...#.#...#.....#...#.....#.....#.......#.#...#...#...#.......#.#.#...#.....#.#.#.#.###
###.#.#########.#.#####.#.#####################.#.#.#.###.#.#############.#####.#.###.#######.#.#.###.#.#.#.#######.#.#.###.#####.#.#.#.#.###
#...#.#.....###.#.#...#.#.###...................#...#.#...#.#.....#.......#...#...###.......#...#.....#...#.........#.#.###.......#...#.#...#
#.###.#.###.###.#.#.#.#.#.###.#######################.#.###.#.###.#.#######.#.#############.#########################.#.###############.###.#
#...#...#...#...#...#...#...#.....................###...#...#...#...###.....#...#...###...#.#...#...............#...#...#...###...#...#.#...#
###.#####.###.#############.#####################.#######.#####.#######.#######.#.#.###.#.#.#.#.#.#############.#.#.#####.#.###.#.#.#.#.#.###
#...#...#.#...#...........#.#.................#...#...#...#.....#.....#...#.....#.#.#...#...#.#.#.#.............#.#...#...#.....#...#.#.#...#
#.###.#.#.#.###.#########.#.#.###############.#.###.#.#.###.#####.###.###.#.#####.#.#.#######.#.#.#.#############.###.#.#############.#.###.#
#.....#.#.#.....#.......#.#.#...............#.#...#.#.#...#.#...#.#...#...#...#...#.#.......#.#...#...#...###...#.#...#.#.............#.....#
#######.#.#######.#####.#.#.###############.#.###.#.#.###.#.#.#.#.#.###.#####.#.###.#######.#.#######.#.#.###.#.#.#.###.#.###################
#.......#.......#.....#.#.#.#.............#.#.....#.#...#.#.#.#.#.#...#.#.....#...#.###...#.#...#...#...#.....#...#.....#.............#.....#
#.#############.#####.#.#.#.#.###########.#.#######.###.#.#.#.#.#.###.#.#.#######.#.###.#.#.###.#.#.#################################.#.###.#
#...#...#.....#.#.....#...#...#.........#...#...###...#.#.#...#.#...#.#.#.#...#...#.....#.#.#...#.#...........#.....#.........#.......#.#...#
###.#.#.#.###.#.#.#############.#######.#####.#.#####.#.#.#####.###.#.#.#.#.#.#.#########.#.#.###.###########.#.###.#.#######.#.#######.#.###
###...#...#...#...#.....#...#...#.......#...#.#.#.....#.#.#.....#...#...#.#.#.#.....#.....#...###...........#.#.#...#.......#.#.....#...#...#
###########.#######.###.#.#.#.###.#######.#.#.#.#.#####.#.#.#####.#######.#.#.#####.#.#####################.#.#.#.#########.#.#####.#.#####.#
#...#...#...#...#...###.#.#...###.......#.#.#.#.#.....#...#.....#.#.....#.#.#...#...#...###...###...........#.#.#...#...#...#.#...#...#.....#
#.#.#.#.#.###.#.#.#####.#.#############.#.#.#.#.#####.#########.#.#.###.#.#.###.#.#####.###.#.###.###########.#.###.#.#.#.###.#.#.#####.#####
#.#...#...#...#...#...#...#.......#...#.#.#.#.#...#...#.......#.#...###.#...#...#...#...#...#...#.........###.#...#.#.#.#...#.#.#.#...#.....#
#.#########.#######.#.#####.#####.#.#.#.#.#.#.###.#.###.#####.#.#######.#####.#####.#.###.#####.#########.###.###.#.#.#.###.#.#.#.#.#.#####.#
#.....#.....#...#...#...###.....#...#...#.#.#...#.#...#.....#...###...#.#.....#.....#.#...#.....#...#...#...#.....#...#.#...#...#...#...#...#
#####.#.#####.#.#.#####.#######.#########.#.###.#.###.#####.#######.#.#.#.#####.#####.#.###.#####.#.#.#.###.###########.#.#############.#.###
#...#...#...#.#.#.....#.#...###.......#...#...#.#.#...#.....#.......#.#.#.....#.....#.#.#...#...#.#...#.....#.........#.#.............#.#...#
#.#.#####.#.#.#.#####.#.#.#.#########.#.#####.#.#.#.###.#####.#######.#.#####.#####.#.#.#.###.#.#.###########.#######.#.#############.#.###.#
#.#.#.....#...#.......#...#...#.......#.#.....#.#.#...#.#...#.......#.#.#.....#...#.#.#.#.###.#.#.........#...#.......#...#...........#.....#
#.#.#.#######################.#.#######.#.#####.#.###.#.#.#.#######.#.#.#.#####.#.#.#.#.#.###.#.#########.#.###.#########.#.#################
#.#...#...#.................#...#...#...#.#...#.#.#...#.#.#...#...#.#.#.#.#...#.#.#.#...#.#...#.#...#...#.#.#...#.....#...#...#.............#
#.#####.#.#.###############.#####.#.#.###.#.#.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#.#####.#.###.#.#.#.#.#.#.#.###.###.#.#####.#.###########.#
#.....#.#.#.#.....###...#...#...#.#...#...#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#...#.....#...#...#.#.#.#...#.###.#...#.....#...#...........#
#####.#.#.#.#.###.###.#.#.###.#.#.#####.###.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#####.#######.#####.#.#.#####.###.#.#######.#####.###########
#.....#.#...#...#.....#...#...#.#.....#...#.#...#.#...#.#...#.#.#.#.#...#.#.#.#...#...#.....#...#...#.#.....#.....#.#...###.#...#...#...#...#
#.#####.#######.###########.###.#####.###.#.#####.#.###.#.###.#.#.#.#####.#.#.###.#.###.###.###.#.###.#####.#######.#.#.###.#.#.###.#.#.#.#.#
#.....#...#...#...#...#...#.#...#...#...#...###...#.#...#...#...#.#.....#.#.#...#.#...#...#...#.#...#...#...#.....#...#...#.#.#...#...#...#.#
#####.###.#.#.###.#.#.#.#.#.#.###.#.###.#######.###.#.#####.#####.#####.#.#.###.#.###.###.###.#.###.###.#.###.###.#######.#.#.###.#########.#
#...#.....#.#...#...#.#.#.#.#...#.#...#.#.......#...#.#...#.....#...#...#...###.#.###.#...#...#.#...#...#...#.###.#.......#...###.#...#.....#
#.#.#######.###.#####.#.#.#.###.#.###.#.#.#######.###.#.#.#####.###.#.#########.#.###.#.###.###.#.###.#####.#.###.#.#############.#.#.#.#####
#.#...#...#...#.......#.#...#...#.#...#.#.#...#...###...#...#...###.#.........#...#...#...#.#...#.....#...#.#.#...#.....###.....#.#.#.#.....#
#.###.#.#.###.#########.#####.###.#.###.#.#.#.#.###########.#.#####.#########.#####.#####.#.#.#########.#.#.#.#.#######.###.###.#.#.#.#####.#
#...#.#.#.###...#...#...#.....#...#...#.#.#.#.#.#...#.......#.#...#.....#...#.#.....#...#.#.#...#.......#...#.#.......#...#.#...#...#.....#.#
###.#.#.#.#####.#.#.#.###.#####.#####.#.#.#.#.#.#.#.#.#######.#.#.#####.#.#.#.#.#####.#.#.#.###.#.###########.#######.###.#.#.###########.#.#
#...#...#.#...#...#.#.###.....#.#.....#.#.#.#.#...#.#.#.....#...#.....#.#.#...#...#...#...#.....#.#.....#...#.......#...#...#...#.....###...#
#.#######.#.#.#####.#.#######.#.#.#####.#.#.#.#####.#.#.###.#########.#.#.#######.#.#############.#.###.#.#.#######.###.#######.#.###.#######
#.......#...#.......#...###...#.#.#...#.#...#.#.....#...###...#...#...#.#.....###...#.........###...#...#.#.....#...###.#...#...#.#...#...###
#######.###############.###.###.#.#.#.#.#####.#.#############.#.#.#.###.#####.#######.#######.#######.###.#####.#.#####.#.#.#.###.#.###.#.###
#.......#...#...#.....#...#...#.#...#.#.#.....#.......#...#...#.#.#...#.#...#.......#.......#.........#...#.....#.....#.#.#.#.....#.....#...#
#.#######.#.#.#.#.###.###.###.#.#####.#.#.###########.#.#.#.###.#.###.#.#.#.#######.#######.###########.###.#########.#.#.#.###############.#
#...#...#.#...#.#...#...#.###.#.###...#.#.#...#.....#.#.#.#.#...#.....#.#.#...#.....###...#.#.......#...###.......#...#...#.#.............#.#
###.#.#.#.#####.###.###.#.###.#.###.###.#.#.#.#.###.#.#.#.#.#.#########.#.###.#.#######.#.#.#.#####.#.###########.#.#######.#.###########.#.#
#...#.#.#...#...#...###.#.#...#...#.#...#.#.#.#...#.#.#.#...#.........#.#.#...#.......#.#...#.....#.#.......#.....#.....###.#...........#.#.#
#.###.#.###.#.###.#####.#.#.#####.#.#.###.#.#.###.#.#.#.#############.#.#.#.#########.#.#########.#.#######.#.#########.###.###########.#.#.#
#.#...#...#.#.#...#.....#.#...#...#.#...#...#.#...#...#...#...#...#...#.#.#...#.....#.#...#...#...#.....#...#.#...#...#...#...#.......#.#.#.#
#.#.#####.#.#.#.###.#####.###.#.###.###.#####.#.#########.#.#.#.#.#.###.#.###.#.###.#.###.#.#.#.#######.#.###.#.#.#.#.###.###.#.#####.#.#.#.#
#...#.....#.#.#.###...#...#...#...#.#...#...#.#...###.....#.#.#.#.#...#.#.#...#...#.#.#...#.#.#.#.......#...#.#.#.#.#.#...#...#...###...#...#
#####.#####.#.#.#####.#.###.#####.#.#.###.#.#.###.###.#####.#.#.#.###.#.#.#.#####.#.#.#.###.#.#.#.#########.#.#.#.#.#.#.###.#####.###########
#.....#...#.#...#...#...###.#...#.#.#.#...#...#...#...#.....#...#.#...#.#.#...#...#...#...#.#.#.#.#.....#...#.#.#.#.#.#.###.....#.........###
#.#####.#.#.#####.#.#######.#.#.#.#.#.#.#######.###.###.#########.#.###.#.###.#.#########.#.#.#.#.#.###.#.###.#.#.#.#.#.#######.#########.###
#...#...#.#.#.....#.###.....#.#.#.#.#.#.#...#...###...#.......###...###...###...###...#...#.#.#.#.#.###.#.###.#.#.#.#.#.......#...#.....#...#
###.#.###.#.#.#####.###.#####.#.#.#.#.#.#.#.#.#######.#######.#####################.#.#.###.#.#.#.#.###.#.###.#.#.#.#.#######.###.#.###.###.#
#...#...#.#.#.#...#.....#...#.#.#.#.#.#.#.#.#.#.......#.....#...................#...#...#...#.#.#.#.#...#...#.#.#.#.#...#...#.#...#...#...#.#
#.#####.#.#.#.#.#.#######.#.#.#.#.#.#.#.#.#.#.#.#######.###.###################.#.#######.###.#.#.#.#.#####.#.#.#.#.###.#.#.#.#.#####.###.#.#
#.......#...#...#.........#...#...#...#...#...#.........###.....................#.........###...#...#.......#...#...###...#...#.......###...#
#############################################################################################################################################`
.split('\n').map(row => row.split(''));

const height = maze.length; const width = maze[0].length;

const validNext = ([x2,y2], phasing) => (x2 >= 0 && x2 < width && y2 >= 0 && y2 < height) && (maze[y2][x2] !== '#' || phasing);

const findCoords = letter => {
  const y = maze.findIndex(row => row.find(v => v === letter));
  const x = maze[y].findIndex(v => v === letter);
  return [x,y];
}

const start = findCoords('S');
const end = findCoords('E');



function solve() {
  const costs = {};
  let priorityPositions = [{pos: start, cost: 0, phased: null}];
  let positions = [];
  let savings = {};
  let baseCost;

  while (positions.length || priorityPositions.length) {

    const {pos, cost, phased} = priorityPositions.length ? priorityPositions.pop() : positions.pop();
  
    const lookupKey = `${pos},${phased}`;
    const baseLookupKey = `${pos},${null}`;
    const [x,y] = pos;

    if (phased && costs[baseLookupKey]) {
      const delta = costs[baseLookupKey] - cost;
      savings[phased] = savings[phased] ? Math.max(savings[phased], delta) : delta;
      continue;
    }
  
    if (!costs[lookupKey] || costs[lookupKey] > cost) {
      costs[lookupKey] = cost;
    } else {
      continue;
    }
  
    

    const pushNext = (vec, newcost, phased) => {
      if (!phased) {
        if (validNext(vec, false)) {
          priorityPositions.push({pos: vec, cost: newcost, phased})
        } else if (validNext(vec, true)) {
          positions.push({pos: vec, cost: newcost, phased: vec});
        }
      } else if (validNext(vec, false)) {
        positions.push({pos: vec, cost: newcost, phased});
      }
    }

    pushNext([x+1,y], cost+1, phased);
    pushNext([x-1,y], cost+1, phased);
    pushNext([x,y+1], cost+1, phased);
    pushNext([x,y-1], cost+1, phased);
  
    // FOUND IT!
    if (x === end[0] && y === end[1]) {
      if (!phased) {
        baseCost ??= cost;
        baseCost = Math.min(baseCost, cost);
      }

      if (phased) {
        throw new Error("OH NO");
      }
    }
  }
  return {savings};
}

const {savings} = solve();
console.log(Object.entries(savings).filter(([a,b]) => b>=100).length);

